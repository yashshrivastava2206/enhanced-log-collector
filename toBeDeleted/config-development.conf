#!/bin/bash
################################################################################
# Enhanced Log Collector - Development Configuration
# Author: Yash Shrivastava
# Copyright: Â© 2026 Yash Shrivastava
# License: MIT
# Version: 2.0.0
# Environment: Development
################################################################################

# ==============================================================================
# BASE CONFIGURATION
# ==============================================================================

BASE_LOG_DIR="/var/log/dev"
DEFAULT_OWNER="developer:developer"
SCRIPT_VERSION="2.0.0"

# ==============================================================================
# LOG ROTATION SETTINGS
# ==============================================================================

# Smaller files for easier testing
MAX_LOG_SIZE_MB=10

# Short retention for development
LOG_RETENTION_DAYS=3
ARCHIVE_RETENTION_DAYS=7

# Disable compression for easier viewing
ENABLE_COMPRESSION=false

COMPRESSION_LEVEL=1

# ==============================================================================
# OUTPUT FORMAT SETTINGS
# ==============================================================================

DEFAULT_OUTPUT_FORMAT="plain"

# Enable JSON for testing integrations
ENABLE_JSON_FORMAT=true

# Always show console output in dev
ENABLE_CONSOLE_OUTPUT=true

# Local syslog only
ENABLE_SYSLOG=true
SYSLOG_FACILITY="local7"
SYSLOG_SERVER=""

# ==============================================================================
# EMAIL ALERT SETTINGS
# ==============================================================================

# Disable email alerts in development
ENABLE_EMAIL_ALERTS=false

# Use developer email for testing
ALERT_EMAIL="developer@localhost"

# Alert on more levels for testing
ALERT_LEVELS="ERROR,CRITICAL,FATAL"

EMAIL_SUBJECT_PREFIX="[DEV-LOG]"
EMAIL_FROM="logcollector@dev.localhost"
SMTP_SERVER=""
SMTP_PORT=25

# ==============================================================================
# PERFORMANCE SETTINGS
# ==============================================================================

# Disable async for easier debugging
ASYNC_COMPRESSION=false

ENABLE_SIZE_CACHE=false
SIZE_CACHE_TIMEOUT=30
MAX_COMPRESSION_JOBS=2

# ==============================================================================
# RATE LIMITING
# ==============================================================================

# Disable rate limiting in development
ENABLE_RATE_LIMIT=false

RATE_LIMIT_MAX=1000
RATE_LIMIT_WINDOW=60
RATE_LIMIT_ACTION="drop"

# ==============================================================================
# LOG SAMPLING
# ==============================================================================

# No sampling in dev - log everything
ENABLE_SAMPLING=false
SAMPLE_RATE=100
SAMPLE_EXEMPT_LEVELS="ERROR,CRITICAL,FATAL"

# ==============================================================================
# RETENTION POLICIES BY LOG LEVEL
# ==============================================================================

# Keep all levels for same short duration
DEBUG_RETENTION_DAYS=3
INFO_RETENTION_DAYS=3
NOTICE_RETENTION_DAYS=3
WARNING_RETENTION_DAYS=7
ERROR_RETENTION_DAYS=7
CRITICAL_RETENTION_DAYS=14
FATAL_RETENTION_DAYS=14

# ==============================================================================
# SECURITY SETTINGS
# ==============================================================================

# More permissive in dev
LOG_FILE_PERMISSIONS=644
LOG_DIR_PERMISSIONS=755

VALIDATE_CONFIG_PERMISSIONS=false
SANITIZE_INPUT=true
MAX_TASK_NAME_LENGTH=100
MAX_MESSAGE_LENGTH=65536

# ==============================================================================
# MONITORING & HEALTH
# ==============================================================================

ENABLE_HEALTH_CHECK=true
HEALTH_CHECK_FILE="/tmp/logCollector.health"
HEALTH_CHECK_INTERVAL=30

ENABLE_METRICS=true
METRICS_FILE="/tmp/logCollector_metrics.txt"
METRICS_INTERVAL=60

# ==============================================================================
# STORAGE MANAGEMENT
# ==============================================================================

# Lower thresholds for dev
MIN_FREE_DISK_MB=100
DISK_WARNING_THRESHOLD=70
DISK_CRITICAL_THRESHOLD=85
DISK_CRITICAL_ACTION="alert"

# ==============================================================================
# ADVANCED FEATURES
# ==============================================================================

# Enable all features for testing
ENABLE_LOG_STREAMING=true
LOG_STREAM_SOCKET="/tmp/logCollector.sock"

ENABLE_STRUCTURED_LOGGING=true
INCLUDE_STACK_TRACES=true
MAX_STACK_TRACE_DEPTH=20

# ==============================================================================
# INTEGRATION SETTINGS
# ==============================================================================

# All disabled by default - enable for testing
ENABLE_ELASTICSEARCH=false
ELASTICSEARCH_HOST="localhost"
ELASTICSEARCH_PORT=9200
ELASTICSEARCH_INDEX="logcollector-dev"

ENABLE_SPLUNK=false
SPLUNK_HOST=""
SPLUNK_PORT=8088
SPLUNK_TOKEN=""

ENABLE_DATADOG=false
DATADOG_API_KEY=""
DATADOG_SITE="datadoghq.com"

# ==============================================================================
# DEBUGGING
# ==============================================================================

# Full debugging enabled
DEBUG_MODE=true
DEBUG_LOG_FILE="/tmp/logCollector_debug.log"
LOG_CONFIG_ON_STARTUP=true

# ==============================================================================
# CLEANUP SETTINGS
# ==============================================================================

# More aggressive cleanup for testing
CLEANUP_CHECK_PROBABILITY=10
CLEANUP_SCHEDULE=""  # Manual cleanup only
TEMP_FILE_MAX_AGE=1

# ==============================================================================
# CUSTOM METADATA
# ==============================================================================

CUSTOM_METADATA_ENABLED=true
METADATA_ENVIRONMENT="development"
METADATA_DATACENTER="local"
METADATA_CLUSTER="dev-workstation"
METADATA_VERSION="$SCRIPT_VERSION"
METADATA_DEVELOPER="$(whoami)"

# ==============================================================================
# TIMEZONE
# ==============================================================================

LOG_TIMEZONE="$(date +%Z)"
TIMESTAMP_FORMAT="iso8601"
CUSTOM_TIMESTAMP_FORMAT="%Y-%m-%d %H:%M:%S %z"

# ==============================================================================
# DEVELOPMENT-SPECIFIC SETTINGS
# ==============================================================================

# Enable verbose error messages
VERBOSE_ERRORS=true

# Enable trace logging
ENABLE_TRACE=true

# Show file and line numbers in logs
SHOW_SOURCE_LOCATION=true

# Enable performance profiling
ENABLE_PROFILING=true

# Profile output file
PROFILE_OUTPUT="/tmp/logCollector_profile.txt"

# ==============================================================================
# END OF CONFIGURATION
# ==============================================================================
